<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Social</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" />
    <link rel="icon" type="image/png" href="/images/icon.png" />
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>

<style>
    #main-section {
        margin-top: 3rem;
    }

    .nav-link {
        position: relative;
        color: #333;
        font-size: 1rem;
        font-weight: 500;
        transition: color 0.3s ease, transform 0.3s ease;
    }

    .nav-link:hover {
        color: #1d4ed8;
        transform: scale(1.1);
    }

    .nav-link:before {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 0;
        height: 2px;
        background-color: #1d4ed8;
        transition: width 0.3s ease;
    }

    .nav-link:hover:before {
        width: 100%;
    }

    /* Navbar styling */
    .navbar {
        background-color: #fff;
        padding: 0.75rem 2rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    .navbar-brand {
        font-size: 1.75rem;
        font-weight: bold;
        color: #333;
        text-transform: uppercase;
    }

    /* Profile Dropdown */
    .profile-container {
        position: relative;
    }

    .profile-dropdown {
        position: absolute;
        right: 0;
        top: 100%;
        background-color: #fff;
        width: 180px;
        padding: 10px 0;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px);
        transition: all 0.3s ease;
    }

    .profile-container:hover .profile-dropdown {
        opacity: 1;
        visibility: visible;
        transform: translateY(0);
    }

    .profile-dropdown a {
        padding: 12px;
        display: block;
        color: #333;
        font-size: 1rem;
        text-decoration: none;
        transition: background-color 0.3s ease;
    }

    .profile-dropdown a:hover {
        background-color: #f1f1f1;
    }

    /* Hamburger Menu */
    .menu-btn {
        display: flex;
        flex-direction: column;
        justify-content: space-around;
        width: 24px;
        height: 24px;
        border: none;
        background: transparent;
        cursor: pointer;
        padding: 0;
        z-index: 10;
    }

    .menu-btn div {
        width: 24px;
        height: 3px;
        background: #333;
        border-radius: 10px;
        transition: all 0.3s linear;
    }

    .menu-btn.open div:nth-child(1) {
        transform: rotate(45deg);
    }

    .menu-btn.open div:nth-child(2) {
        opacity: 0;
        transform: translateX(20px);
    }

    .menu-btn.open div:nth-child(3) {
        transform: rotate(-45deg);
    }

    /* Mobile Menu */
    .mobile-menu {
        position: fixed;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        background: rgba(0, 0, 0, 0.7);
        transform: translateX(100%);
        transition: transform 0.3s ease;
        z-index: 20;
    }

    .mobile-menu.open {
        transform: translateX(0);
    }

    .mobile-menu ul {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100%;
    }

    .mobile-menu ul li {
        margin: 15px 0;
    }

    .mobile-menu a {
        font-size: 1.25rem;
        color: #fff;
        text-decoration: none;
        text-transform: uppercase;
        font-weight: bold;
        transition: color 0.3s ease;
    }

    .mobile-menu a:hover {
        color: #1d4ed8;
    }

    /* Custom Scrollbar for Stories Section */
    .stories-container::-webkit-scrollbar {
        width: 6px;
    }

    .stories-container::-webkit-scrollbar-thumb {
        background: #1d4ed8;
        border-radius: 10px;
    }

    .fade-out {
        animation: fadeOutUp 0.5s forwards;
    }

    @keyframes fadeOutUp {
        0% {
            opacity: 1;
            transform: translateY(0);
        }

        100% {
            opacity: 0;
            transform: translateY(-20px);
        }
    }

    #right-section {
        max-height: 1000px;
        overflow-y: auto;
        width: 28%;
    }

    /* Custom CSS to fix button spacing issue */
    #right-section .action-buttons {
        display: flex;
        gap: 0px;
        /* Adjust gap as necessary */
    }

    #right-section .friend-request {
        display: flex;
        justify-content: space-between;
        align-items: center;
        overflow: hidden;
    }

    #right-section .friend-request .action-buttons {
        flex-shrink: 0;
        /* Prevents buttons from shrinking */
    }

    #right-section .friend-request .flex-grow {
        flex-grow: 1;
        /* Allows name to take up available space */
    }

    #right-section .friend-request p {
        display: -webkit-box;
        -webkit-box-orient: vertical;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: normal;
        /* Allow wrapping */
    }

    #middle-section {
        width: 46%;
    }
</style>

<body class="bg-gray-100 text-gray-800">

    <!-- Navbar -->
    <nav class="navbar bg-gray-100 dark:bg-gray-800 px-6 py-4 fixed top-0 left-0 w-full z-50">
        <div class="flex justify-between items-center">
            <!-- Logo / Branding -->
            <a href="#" class="navbar-brand text-gray-800 dark:text-gray-200 text-xl font-bold">Social</a>
            <!-- Search Box -->
            <div class="relative">
                <input type="text" id="search" placeholder="Search Pages"
                    class="py-2 px-4 w-96 border border-gray-300 dark:border-gray-700 rounded-lg bg-gray-100 dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white"
                    oninput="searchFunction()">
                <button onclick="searchFunction()"
                    class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 dark:text-gray-400">
                    <i class="fas fa-search"></i>
                </button>
            </div>

            <script>
                function searchFunction() {
                    const query = document.getElementById('search').value.toLowerCase();
                    // For demonstration, we are simply logging the search query.
                    // You can replace this with actual functionality like filtering content or making an API call.
                    console.log('Searching for:', query);
                    // Example: If you have a list of items, you can filter them as follows:
                    // const items = document.querySelectorAll('.item');
                    // items.forEach(item => {
                    //   item.style.display = item.textContent.toLowerCase().includes(query) ? 'block' : 'none';
                    // });
                }
            </script>


            <!-- Desktop Links -->
            <div class="hidden md:flex items-center space-x-6">
                <a href="#" class="nav-link text-gray-700 dark:text-gray-300 hover:text-blue-500">Home</a>
                <a href="#" class="nav-link text-gray-700 dark:text-gray-300 hover:text-blue-500">Explore</a>
                <a href="/messages" class="nav-link text-gray-700 dark:text-gray-300 hover:text-blue-500">Messages</a>
                <a href="/register" class="btn-primary bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                    Create
                </a>




                <!-- Profile Dropdown -->
                <div class="profile-container">
                    <img src="https://i.pravatar.cc/150?img=3" alt="Profile"
                        class="h-10 w-10 rounded-full cursor-pointer" />
                    <div class="profile-dropdown">
                        <a href="#">Profile</a>
                        <a href="#">Settings</a>
                        <a href="#">Logout</a>
                    </div>
                </div>
            </div>

            <!-- Mobile Hamburger Menu -->
            <div class="md:hidden">
                <button id="menu-btn" class="menu-btn">
                    <div class="w-6 h-1 bg-gray-800 dark:bg-gray-200 mb-1"></div>
                    <div class="w-6 h-1 bg-gray-800 dark:bg-gray-200 mb-1"></div>
                    <div class="w-6 h-1 bg-gray-800 dark:bg-gray-200"></div>
                </button>
            </div>
        </div>
    </nav>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="mobile-menu hidden bg-gray-100 dark:bg-gray-800 px-6 py-4 md:hidden">
        <ul class="space-y-4">
            <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-500">Home</a></li>
            <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-500">Explore</a></li>
            <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-500">Messages</a></li>
            <li><button
                    class="btn-primary bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">Create</button>
            </li>
        </ul>
    </div>

    <!-- Main Section -->
    <main class="container mx-auto py-6 " id="main-section">
        <div class="flex flex-wrap">
            <!-- Left Section -->
            <div class="w-full md:w-1/4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg h-full  ">
                <!-- Profile & Navigation Section -->
                <div class="mb-8 pb-6 border-b border-gray-200 dark:border-gray-700">
                    <a href="#"
                        class="flex items-center space-x-4 mb-6 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-md hover:shadow-lg transition duration-300 transform hover:scale-105">
                        <div class="profile-pic">
                            <img src="https://th.bing.com/th/id/OIP.hIuJO0PIE2kRkLgyTLis5AHaFj?w=234&h=180&c=7&r=0&o=5&pid=1.7"
                                alt="" class="h-12 w-12 rounded-full border-2 border-blue-500" />
                        </div>
                        <div class="handle">
                            <h4 class="text-lg font-bold text-gray-700 dark:text-gray-200">Jane Smith</h4>
                            <p class="text-sm text-gray-500 dark:text-gray-400">@jsmith</p>
                        </div>
                    </a>

                    <div class="space-y-4">
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105">
                            <i class="fas fa-home"></i>
                            <h3>Home</h3>
                        </a>
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105">
                            <i class="fa-regular fa-compass"></i>
                            <h3>Explore</h3>
                        </a>
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105">
                            <i class="fas fa-bell"></i>
                            <h3>Notifications</h3>
                        </a>
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105">
                            <i class="fas fa-comments"></i>
                            <h3>Messages</h3>
                        </a>
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105">
                            <i class="fas fa-bookmark"></i>
                            <h3>Bookmarks</h3>
                        </a>
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105">
                            <i class="fas fa-chart-line"></i>
                            <h3>Analytics</h3>
                        </a>
                    </div>
                </div>

                <!-- Topics Section -->
                <div class="pt-2">
                    <div class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 p-2 mb-4">
                        <h3 class="text-lg font-bold text-gray-700 dark:text-gray-200">Choose Topic</h3>
                    </div>

                    <div class="space-y-4">
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105"
                            onclick="loadPostsByTopic('technology')">
                            <i class="fas fa-laptop-code"></i>
                            <h3>Technology</h3>
                        </a>
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105"
                            onclick="loadPostsByTopic('news')">
                            <i class="fas fa-newspaper"></i>
                            <h3>News</h3>
                        </a>
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105"
                            onclick="loadPostsByTopic('fitness')">
                            <i class="fas fa-dumbbell"></i>
                            <h3>Fitness</h3>
                        </a>
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105"
                            onclick="loadPostsByTopic('sports')">
                            <i class="fas fa-basketball-ball"></i>
                            <h3>Sports</h3>
                        </a>
                        <a href="#"
                            class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 p-2 rounded-lg transition duration-300 transform hover:scale-105"
                            onclick="loadPostsByTopic('movies')">
                            <i class="fas fa-film"></i>
                            <h3>Movies</h3>
                        </a>
                    </div>
                </div>
            </div>


            <div class="w-full md:w-1/2 p-4 overflow-hidden bg-white dark:bg-gray-800" id="middle-section">
                <!-- Profile Section -->


                <!-- Topic Selection -->


                <!-- Post Form -->
                <form
                    class="create-post mb-6 bg-white dark:bg-gray-800 p-6 rounded-xl shadow-md transition-all hover:shadow-2xl">
                    <div class="flex items-center space-x-4">
                        <div class="profile-pic">
                            <img src="https://th.bing.com/th/id/OIP.MsVr4gq1qbiRSIP4Egf0OgHaLO?w=115&h=180&c=7&r=0&o=5&pid=1.7"
                                alt="Profile"
                                class="h-12 w-12 rounded-full border-2 border-gray-300 dark:border-gray-600 shadow-md" />
                        </div>
                        <input type="text" placeholder="What's on your mind?" id="create-post"
                            class="flex-grow py-2 px-4 border border-gray-300 dark:border-gray-700 rounded-lg bg-gray-100 dark:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-200" />

                    </div>
                    <label
                        class="btn btn-primary mt-6 block text-center bg-yellow-500 text-white py-2 px-4 rounded-lg cursor-pointer hover:bg-yellow-600 transition duration-300 transform hover:scale-105"
                        for="create-post">
                        <i class="fas fa-plus"></i> Create Post
                    </label>
                </form>

                <!-- News Feed with Infinite Scrolling -->
                <div id="post-feed" class="news-feeds space-y-6">
                    <!-- Feed items will be dynamically inserted here -->
                </div>

                <!-- Loading Indicator -->
                <div id="loading-indicator" class="hidden text-center py-4">
                    <span class="text-gray-500">Loading more posts...</span>
                </div>
            </div>


            <!-- Right Section -->
            <div id="right-section"
                class="w-full md:w-1/4 p-4 bg-white dark:bg-gray-800 rounded-lg shadow-lg space-y-6 overflow-y-auto max-h-[500px] ">
                <!-- Ads Section -->
                <div id="ads-section" class="bg-gray-100 dark:bg-gray-700 rounded-lg p-4 shadow-md">
                    <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-4">Sponsored Ads</h3>
                    <!-- Dynamic Ad Items Will Appear Here -->
                </div>

                <!-- Friend Requests Section -->
                <!-- Friend Requests Section -->
                <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-4 shadow-md">
                    <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-4">Friend Requests</h3>
                    <div class="space-y-4" id="friend-requests-container">
                        <!-- Friend Request 1 -->
                        <div
                            class="friend-request flex justify-between items-center bg-gray-200 dark:bg-gray-600 p-3 rounded-lg shadow-sm hover:bg-gray-300 dark:hover:bg-gray-500 transition">
                            <div class="flex items-center space-x-3 w-full">
                                <img src="https://th.bing.com/th/id/OIP._ngYF3KIPcb4GMzItOQbCQHaE9?w=281&h=187&c=7&r=0&o=5&pid=1.7"
                                    alt="Friend 1" class="w-10 h-10 rounded-full border-2 border-blue-500" />
                                <p class="text-gray-700 dark:text-gray-300 flex-grow line-clamp-2">John Doe</p>
                            </div>
                            <div class="action-buttons flex space-x-2 ml-2">
                                <button
                                    class="accept-btn bg-blue-500 hover:bg-blue-600 text-white py-1 px-3 rounded-md flex items-center transition"
                                    onclick="handleActionClick(this)">
                                    <i class="fas fa-check mr-2"></i> Accept
                                </button>
                                <button
                                    class="decline-btn bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded-md flex items-center transition"
                                    onclick="handleActionClick(this)">
                                    <i class="fas fa-times mr-2"></i> Decline
                                </button>
                            </div>
                        </div>

                        <!-- Friend Request 2 -->
                        <div
                            class="friend-request flex justify-between items-center bg-gray-200 dark:bg-gray-600 p-3 rounded-lg shadow-sm hover:bg-gray-300 dark:hover:bg-gray-500 transition">
                            <div class="flex items-center space-x-3 w-full">
                                <img src="https://th.bing.com/th/id/OIP.kKNSidGj6Qwgpb1cj1oDJAHaE7?w=281&h=187&c=7&r=0&o=5&pid=1.7"
                                    alt="Friend 2" class="w-10 h-10 rounded-full border-2 border-blue-500" />
                                <p class="text-gray-700 dark:text-gray-300 flex-grow line-clamp-2">Sarah Smith</p>
                            </div>
                            <div class="action-buttons flex space-x-2 ml-2">
                                <button
                                    class="accept-btn bg-blue-500 hover:bg-blue-600 text-white py-1 px-3 rounded-md flex items-center transition"
                                    onclick="handleActionClick(this)">
                                    <i class="fas fa-check mr-2"></i> Accept
                                </button>
                                <button
                                    class="decline-btn bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded-md flex items-center transition"
                                    onclick="handleActionClick(this)">
                                    <i class="fas fa-times mr-2"></i> Decline
                                </button>
                            </div>
                        </div>
                        <div
                            class="friend-request flex justify-between items-center bg-gray-200 dark:bg-gray-600 p-3 rounded-lg shadow-sm hover:bg-gray-300 dark:hover:bg-gray-500 transition">
                            <div class="flex items-center space-x-3 w-full">
                                <img src="https://ntvb.tmsimg.com/assets/assets/70021_v9_bc.jpg" alt="Friend 3"
                                    class="w-10 h-10 rounded-full border-2 border-blue-500" />
                                <p class="text-gray-700 dark:text-gray-300 flex-grow line-clamp-2">Dave Mathews</p>
                            </div>
                            <div class="action-buttons flex space-x-2 ml-2">
                                <button
                                    class="accept-btn bg-blue-500 hover:bg-blue-600 text-white py-1 px-3 rounded-md flex items-center transition"
                                    onclick="handleActionClick(this)">
                                    <i class="fas fa-check mr-2"></i> Accept
                                </button>
                                <button
                                    class="decline-btn bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded-md flex items-center transition"
                                    onclick="handleActionClick(this)">
                                    <i class="fas fa-times mr-2"></i> Decline
                                </button>
                            </div>
                        </div>




                        <!-- No Requests Placeholder -->
                        <div class="no-requests hidden text-center text-gray-500 dark:text-gray-300 mt-4">
                            <p>No friend requests at the moment!</p>
                        </div>
                    </div>
                </div>

                <!-- Trending Section -->
                <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-4 shadow-md">
                    <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-4">Trending Topics</h3>
                    <ul class="space-y-3">
                        <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-500">#FitnessGoals</a>
                        </li>
                        <li><a href="#"
                                class="text-gray-700 dark:text-gray-300 hover:text-blue-500">#HealthyLifestyle</a></li>
                        <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-500">#GymMotivation</a>
                        </li>
                        <li><a href="#" class="text-gray-700 dark:text-gray-300 hover:text-blue-500">#Mindfulness</a>
                        </li>
                        <li><a href="#"
                                class="text-gray-700 dark:text-gray-300 hover:text-blue-500">#WeightLossJourney</a></li>
                    </ul>
                </div>

                <!-- Activity Feed Section -->
                <div class="bg-gray-100 dark:bg-gray-700 rounded-lg p-4 shadow-md">
                    <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-4">Recent Activity</h3>
                    <div id="activity-feed" class="space-y-4">
                        <div
                            class="activity-item flex items-center justify-between p-3 bg-gray-200 dark:bg-gray-600 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500">
                            <div class="activity-content">
                                <p class="text-gray-700 dark:text-gray-300">You liked a post by John Doe</p>
                                <small class="text-sm text-gray-500 dark:text-gray-400">5 minutes ago</small>
                            </div>
                        </div>
                        <div
                            class="activity-item flex items-center justify-between p-3 bg-gray-200 dark:bg-gray-600 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500">
                            <div class="activity-content">
                                <p class="text-gray-700 dark:text-gray-300">You commented on Sarah's post</p>
                                <small class="text-sm text-gray-500 dark:text-gray-400">15 minutes ago</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


    </main>



    <!-- JavaScript file inclusion -->
    <script>


        // Toggle the hamburger menu
        document.getElementById('menu-btn').addEventListener('click', function () {
            this.classList.toggle('open');
            document.getElementById('mobile-menu').classList.toggle('open');
        });

        const adsData = [
            {
                image: "https://via.placeholder.com/728x90.png?text=Buy+New+Fitness+Gear+Today",
                link: "https://www.amazon.in/l/3403635031",
                text: "Buy New Fitness Gear Today!"
            },
            {
                image: "https://via.placeholder.com/728x90.png?text=Exclusive+Offer+on+Memberships",
                link: "https://www.timesprime.com/",
                text: "Exclusive Offer on Memberships!"
            }
        ];

        function renderAds() {
            const adsSection = document.getElementById("ads-section");

            if (!adsSection) {
                console.error("Ad section not found!");
                return;
            }

            adsSection.innerHTML = '';

            adsData.forEach(ad => {
                const adElement = document.createElement("div");
                adElement.classList.add("ad-item", "mb-4");

                adElement.innerHTML = `
        <a href="${ad.link}" target="_blank" class="block text-center bg-gray-200 dark:bg-gray-600 p-3 rounded-lg shadow-md hover:bg-gray-300 dark:hover:bg-gray-500 transition">
            <img src="${ad.image}" alt="${ad.text}" class="w-full h-auto rounded-lg mb-3" />
            <p class="text-gray-700 dark:text-gray-300">${ad.text}</p>
        </a>
    `;

                adsSection.appendChild(adElement);
            });
        }

        window.onload = function () {
            renderAds();
        };

        function handleActionClick(button) {
            const requestDiv = button.closest('.friend-request');
            const friendRequestsContainer = document.getElementById('friend-requests-container');

            requestDiv.classList.add('fade-out');

            requestDiv.addEventListener('animationend', () => {
                requestDiv.remove();

                const remainingRequests = friendRequestsContainer.querySelectorAll('.friend-request');
                if (remainingRequests.length === 0) {
                    const noRequestsMessage = document.querySelector('.no-requests');
                    noRequestsMessage.classList.remove('hidden');
                }
            });
        }

        // Accept Friend Request
        document.querySelectorAll('.accept-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const friendRequest = e.target.closest('.friend-request');
                friendRequest.classList.add('bg-green-100');
                friendRequest.querySelector('.accept-btn').disabled = true;
                friendRequest.querySelector('.decline-btn').disabled = true;
            });
        });

        document.querySelectorAll('.decline-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const friendRequest = e.target.closest('.friend-request');
                friendRequest.classList.add('bg-green-100');
                friendRequest.querySelector('.accept-btn').disabled = true;
                friendRequest.querySelector('.decline-btn').disabled = true;
            });
        });

        const topicToSubreddit = {
            technology: ['laptop', 'technews', 'gadgets'],
            news: ['worldnews', 'news', 'uknews'],
            fitness: ['fitness', 'nutrition', 'yoga'],
            sports: ['sports', 'soccer', 'basketball'],
            movies: ['movies', 'film', 'moviecritic'],
        };

        let isLoading = false;
        let posts = [];
        let currentTopic = 'technology'; // To track the current active topic
        let after = '';

        function createPost(post) {
            const postElement = document.createElement('div');
            postElement.classList.add('feed-item', 'bg-white', 'dark:bg-gray-800', 'p-4', 'rounded-lg', 'shadow-md', 'hover:shadow-lg', 'transition-all');
            postElement.dataset.postId = post.id;

            postElement.innerHTML = `
        <div class="flex items-center space-x-4">
            <div class="profile-pic"></div>
            <div class="post-author">
                <span class="font-semibold text-gray-900 dark:text-white">${post.author}</span>
                <p class="text-sm text-gray-500 dark:text-gray-400">Posted recently</p>
            </div>
        </div>
        <p class="mt-4 text-gray-800 dark:text-gray-200">${post.title}</p>
        ${post.thumbnail ? `<img src="${post.thumbnail}" alt="Post Image" class="mt-4 w-full h-auto rounded-lg" />` : ''}
        <div class="mt-4 flex justify-between text-gray-600 dark:text-gray-400">
            <button class="like-btn">Like</button>
            <button class="comment-btn">Comment</button>
            <button class="share-btn">Share</button>
        </div>
        <div class="comment-box hidden mt-4">
            <textarea id="comment-text-${post.id}" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Write your comment..."></textarea>
            <button class="submit-comment-btn bg-blue-500 text-white mt-2 p-2 rounded">Submit Comment</button>
        </div>
    `;

            // Like button logic
            const likeButton = postElement.querySelector('.like-btn');
            likeButton.addEventListener('click', () => toggleLike(likeButton));

            // Add event listener for submit comment
            const submitCommentButton = postElement.querySelector('.submit-comment-btn');
            submitCommentButton.addEventListener('click', () => {
                const commentText = postElement.querySelector(`#comment-text-${post.id}`).value;
                if (commentText.trim()) {
                    alert(`Comment posted: ${commentText}`);
                    postElement.querySelector(`#comment-text-${post.id}`).value = ''; // Clear comment box
                }
            });

            // Share functionality
            const shareButton = postElement.querySelector('.share-btn');
            shareButton.addEventListener('click', () => {
                const postUrl = post.url;
                navigator.share({
                    title: post.title,
                    url: postUrl
                }).catch(err => {
                    console.error('Error sharing post:', err);
                });
            });

            // Comment box toggle
            const commentButton = postElement.querySelector('.comment-btn');
            commentButton.addEventListener('click', () => {
                const commentBox = postElement.querySelector('.comment-box');
                commentBox.classList.toggle('hidden');
            });

            return postElement;
        }

        async function fetchRedditPosts(subreddit) {
            const url = `https://www.reddit.com/r/${subreddit}/new.json?after=${after}`;
            const response = await fetch(url);

            if (!response.ok) {
                throw new Error(`Failed to fetch data from subreddit: ${subreddit}`);
            }

            const data = await response.json();

            // Update the after parameter with the new 'after' value for pagination
            after = data.data.after;

            return data.data.children.map(post => {
                let previewImage = post.data?.preview?.images?.[0]?.source?.url;

                // Check for higher resolution images in 'resolutions' array
                if (!previewImage && post.data?.preview?.images?.[0]?.resolutions) {
                    previewImage = post.data.preview.images[0].resolutions[post.data.preview.images[0].resolutions.length - 1]?.url;
                }

                // Fallback to the post's URL if no preview image is found
                const imageUrl = previewImage || post.data.url;

                return {
                    title: post.data.title,
                    url: post.data.url,
                    thumbnail: imageUrl,
                    id: post.data.id,
                    author: post.data.author,
                };
            });
        }

        async function loadPostsByTopic(topic, isInfiniteScroll = false) {
            const subreddits = topicToSubreddit[topic];
            if (!subreddits || subreddits.length === 0) return;

            const postFeed = document.getElementById('post-feed');
            const loadingIndicator = document.getElementById('loading-indicator');

            if (isLoading) return;
            isLoading = true;

            loadingIndicator?.classList.remove('hidden');

            if (!isInfiniteScroll) {
                postFeed.innerHTML = ''; // Clear current posts when not infinite scroll
                posts = []; // Reset the posts array for fresh data
            }

            try {
                let allPosts = [];
                for (let subreddit of subreddits) {
                    const fetchedPosts = await fetchRedditPosts(subreddit);
                    allPosts = [...allPosts, ...fetchedPosts];
                }

                // Remove any previously loaded posts from the new set to avoid duplicates
                allPosts = allPosts.filter(post => !posts.some(existingPost => existingPost.id === post.id));

                // Shuffle the posts after collecting them
                const shuffledPosts = allPosts.sort(() => Math.random() - 0.5);

                if (shuffledPosts.length > 0) {
                    shuffledPosts.forEach(post => {
                        const postElement = createPost(post);
                        postFeed.appendChild(postElement);
                        posts.push(post); // Add the new post to the posts array
                    });
                } else {
                    const noImageMessage = document.createElement('p');
                    noImageMessage.textContent = 'No posts with high-quality images available at the moment.';
                    postFeed.appendChild(noImageMessage);
                }

                loadingIndicator?.classList.add('hidden');
            } catch (error) {
                console.error("Error fetching posts:", error);
                loadingIndicator?.classList.add('hidden');
            } finally {
                isLoading = false;
            }
        }

        // Initialize with default topic
        window.addEventListener('DOMContentLoaded', () => {
            loadPostsByTopic(currentTopic);
        });

        // Topic Selection Handler
        const topicButtons = document.querySelectorAll('.topic-button');
        topicButtons.forEach(button => {
            button.addEventListener('click', () => {
                const selectedTopic = button.dataset.topic;

                // Update the active topic
                currentTopic = selectedTopic;

                // Reset the topic button active state
                topicButtons.forEach(btn => btn.classList.remove('topic-active'));
                button.classList.add('topic-active');

                loadPostsByTopic(selectedTopic);
            });
        });

        // Infinite scrolling
        window.addEventListener('scroll', () => {
            if (isLoading) return;

            if (window.innerHeight + window.scrollY >= document.documentElement.scrollHeight - 100) {
                loadPostsByTopic(currentTopic, true); // Append posts for infinite scrolling based on the current topic
            }
        });
    </script>
</body>

</html>